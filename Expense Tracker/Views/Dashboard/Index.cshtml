@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["isDashboard"] = true;
}
@*Summary Widgets*@
@*Date selector*@
<div class="row">
    <form asp-action="Index" asp-controller="Dashboard" method="post">
        <div class="row align-items-end">
            <div class="col-md-6">
                <div class="mb-3">
                    <ejs-daterangepicker id="DateRange"
                                         startDate="@ViewBag.StartDate"
                                         endDate="@ViewBag.EndDate"
                                         format="dd-MM-yyyy"
                                         locale="en-IN"
                                         placeholder="Select date range"
                                         max="@DateTime.Now">
                    </ejs-daterangepicker>
                </div>
            </div>

            <div class="col-md-2 mb-3">
                <button type="submit" class="btn btn-success"><i class="fa-solid fa-magnifying-glass"></i></button>
            </div>
        </div>

        <!-- These are what ASP.NET will bind -->
        <input type="hidden" id="DateStart" name="DateStart" value="@ViewBag.StartDate" />
        <input type="hidden" id="DateEnd" name="DateEnd" value="@ViewBag.EndDate" />
    </form>
</div>
<div class="row mb-4">
    <div class="col-12">
        <div class="p-3 bg-dark border-start border-4 border-info rounded shadow-sm">
            <h6 class="fw-bold text-light-50 mb-1">
                Transaction Period
            </h6>
            <h5 class="fw-semibold text-light mb-0">
                From
                <span class="text-info fw-bold">
                    @Convert.ToDateTime(ViewBag.StartDate).ToString("dd-MM-yyyy")
                </span>
                to
                <span class="text-warning fw-bold">
                    @Convert.ToDateTime(ViewBag.EndDate).ToString("dd-MM-yyyy")
                </span>
            </h5>
        </div>
    </div>
</div>


@*Total Income*@
<div class="row mb-4">
    <div class="col-md-4">
        <div class="d-flex flex-row widget summary income">
            <div class="d-flex flex-column justify-content-center p-2">
                <i class="fa-solid fa-inr fa-2xl"></i>
            </div>
            <div class="d-flex flex-column m-auto py-3">
                <span class="lead">Total Income</span>
                <h1 class="display-6 fw-bold">@ViewBag.TotalIncome</h1>
            </div>
        </div>
    </div>
@*Total Expense*@
    <div class="col-md-4">
        <div class="d-flex flex-row widget summary expense">
            <div class="d-flex flex-column justify-content-center p-2">
                <i class="fa-solid fa-inr fa-2xl"></i>
            </div>
            <div class="d-flex flex-column m-auto py-3">
                <span class="lead">Total Expense</span>
                <h1 class="display-6 fw-bold">@ViewBag.TotalExpense</h1>
            </div>
        </div>
    </div>

@* Balance*@
    <div class="col-md-4">
        <div class="d-flex flex-row widget summary balance">
            <div class="d-flex flex-column justify-content-center p-2">
                <i class="fa-solid fa-inr fa-2xl"></i>
            </div>
            <div class="d-flex flex-column m-auto py-3">
                <span class="lead">Balance</span>
                <h1 class="display-6 fw-bold">@ViewBag.Balance</h1>
            </div>
        </div>
    </div>
</div>

@*Doughnut and Spline Chart*@
<div class="row mb-4">
    <div class="col-md-4">
        <div class="widget chart">
            <div class="card-subtitle p-5">
                <h5 class="fa-bold">Expense By Category</h5>
            </div>
            <ejs-accumulationchart id="doughnutchart" enableSmartLabels background="#1a222b">
                <e-accumulation-series-collection>
                    <e-accumulation-series dataSource="@ViewBag.DoughnutChart"
                       xName="categoryTitleWithIcon" yName="amount" innerRadius="50%" legendShape="Circle"
                                           palettes=@(new string[]{"#0e8d76","#a4b219","#cb9b00","#49d6f2","#0454b5","#7d0a0a","#822690","#4c2090","#313e93","#0096ac"})>
                        <e-accumulationseries-datalabel visible="true" name="formattedAmount" />
                    </e-accumulation-series>
                </e-accumulation-series-collection>
                <e-accumulationchart-legendsettings visible="true" position="Top" toggleVisibility="false">
                    <e-legendsettings-textstyle size="1rem" color="#fff" />
                </e-accumulationchart-legendsettings>
                <e-accumulationchart-tooltipsettings enable></e-accumulationchart-tooltipsettings>
            </ejs-accumulationchart>
         </div>
    </div>
    <div class="col-md-8">
        <div class="widget chart">
            <div class="card-subtitle p-5">
                <h5 class="fa-bold">Income Vs Expense</h5>
            </div>
            <ejs-chart id="spline-chart" background="#1a222b" palettes=@(new string[]{"#54ffa9","#ffe91a"})>
                <e-chart-primaryxaxis valuetype="Category">
                    <e-majorgridlines width="0"></e-majorgridlines>
                    <e-majorticklines width="0"></e-majorticklines>
                </e-chart-primaryxaxis>
                <e-chart-primaryyaxis>
                    <e-majorgridlines width="1" color="#32414d" dashArray="3,5"></e-majorgridlines>
                    <e-majorticklines width="0"></e-majorticklines>
                    <e-linestyle width="0"></e-linestyle>
                </e-chart-primaryyaxis>
                <e-chart-chartarea>
                    <e-chartarea-border width="0"></e-chartarea-border>
                </e-chart-chartarea>
                <e-series-collection>
                    <e-series dataSource="@ViewBag.SplineChartData" xName="day" yName="income" width="3" name="Income" type="@Syncfusion.EJ2.Charts.ChartSeriesType.Spline"></e-series>
                    <e-series dataSource="@ViewBag.SplineChartData" xName="day" yName="expense" width="3" name="Expense" type="@Syncfusion.EJ2.Charts.ChartSeriesType.Spline"></e-series>
                </e-series-collection>
                <e-chart-legendsettings position="Top" alignment="Far" toggleVisibility="false">
                    <e-legendsettings-textstyle color="#fff" size="1rem"></e-legendsettings-textstyle>
                </e-chart-legendsettings>
                <e-chart-tooltipsettings enable shared></e-chart-tooltipsettings>
            </ejs-chart>
        </div>

    </div>

</div>

@*Recent Trnasc=actions and More*@
<div class="row">
    <div class="col-md-6">
        <div class="widget">
            <div class="p-4">
                <h5 class="fw-bold">Recent Transactions</h5>
            </div>
            <div class="px-4 pb-4">
                <ejs-grid id="recent-transactions"
                          dataSource="@ViewBag.RecentTransactions" gridLines="None">
                    <e-grid-columns>
                        <e-grid-column headerText="Category" field="CategoryTitleWithIcon"></e-grid-column>
                        <e-grid-column headerText="Date" field="Date" type="date" format="dd-MM-yy"></e-grid-column>
                        <e-grid-column headerText="Amount" field="FormattedAmount" textAlign="Right"></e-grid-column>
                    </e-grid-columns>
                </ejs-grid>
            </div>
        </div>
    </div>
    <div class="col-md-6">
        <div class="widget h-100">
            <div class="d-flex justify-content-center align-items-center h-100">
                <span><i class="fa-solid fa-plus fa-2xl"></i> Widget</span>
            </div>
        </div>
    </div>
</div>
<script>
    // Before form submission, inject picker values into hidden fields
     document.querySelector("form").addEventListener("submit", function () {
         var drp = document.getElementById("DateRange").ej2_instances[0];
         document.getElementById("DateStart").value = drp.startDate ? drp.startDate.toISOString() : "";
         document.getElementById("DateEnd").value = drp.endDate ? drp.endDate.toISOString() : "";
    });
</script>